<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="[Unity] Scene View에서 Vector의 Position Handle 조작하기" /><meta property="og:locale" content="en" /><meta name="description" content="Vector의 Position Handle을 Scene View에서 조작하기 위한 알고리즘을 소개한다." /><meta property="og:description" content="Vector의 Position Handle을 Scene View에서 조작하기 위한 알고리즘을 소개한다." /><link rel="canonical" href="https://devslem.github.io/unity/unity-movetool-release1/" /><meta property="og:url" content="https://devslem.github.io/unity/unity-movetool-release1/" /><meta property="og:site_name" content="DevSlem Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-01-17T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[Unity] Scene View에서 Vector의 Position Handle 조작하기" /><meta name="google-site-verification" content="SSJwUK1JSPZV3wjQS19f2bXfHYIupbYEFsisH4Nuns4" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-02-03T00:00:00+09:00","datePublished":"2022-01-17T00:00:00+09:00","description":"Vector의 Position Handle을 Scene View에서 조작하기 위한 알고리즘을 소개한다.","headline":"[Unity] Scene View에서 Vector의 Position Handle 조작하기","mainEntityOfPage":{"@type":"WebPage","@id":"https://devslem.github.io/unity/unity-movetool-release1/"},"url":"https://devslem.github.io/unity/unity-movetool-release1/"}</script><title>[Unity] Scene View에서 Vector의 Position Handle 조작하기 | DevSlem Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="DevSlem Blog"><meta name="application-name" content="DevSlem Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> </a></div><div class="site-title mt-3"> <a href="/">DevSlem Blog</a></div><div class="site-subtitle font-italic">It's a blog where i write posts about AI, RL, Unity, etc.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/DevSlem" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['devslem12','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[Unity] Scene View에서 Vector의 Position Handle 조작하기</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>[Unity] Scene View에서 Vector의 Position Handle 조작하기</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1642345200" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jan 17, 2022 </em> </span> <span> Updated <em class="" data-ts="1643846400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 3, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/username">DevSlem</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="6308 words"> <em>35 min</em> read</span></div></div></div><div class="post-content"><h2 id="1-개요"><span class="mr-2">1. 개요</span><a href="#1-개요" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>유니티로 게임을 만들다 보면 Vector의 Position을 조작하는 일이 수도 없이 많다. 게임 오브젝트의 Position은 <code class="language-plaintext highlighter-rouge">Transform</code> 컴포넌트가 지원하는 자체적인 <strong>Move-Tool</strong> 도구로 Scene View에서 쉽게 위치를 조작할 수 있지만, 일반적인 <code class="language-plaintext highlighter-rouge">Vector2</code> 혹은 <code class="language-plaintext highlighter-rouge">Vector3</code> 타입의 필드의 값을 변경할 때는 수동으로 값을 직접 입력해야 한다. 이는 굉장한 불편함이다. 몰론 Vector 구조체가 아닌, Empty GameObject를 생성 후 <code class="language-plaintext highlighter-rouge">Transform</code> 타입의 필드에 할당하여 조작하면 되지만 Vector 구조체 단독으로 사용하는 것보다는 메모리, 성능 등 효율성이 다소 떨어진다. 구조체의 성능적인 장점을 최대한 활용하는 것이 아무래도 좋지 않겠는가? 아래 장면을 보자.</p><p><img data-src="/assets/images/vector-movetool-control.webp" alt="조작" data-proofer-ignore></p><p>위 장면을 보면 알 수 있지만 <code class="language-plaintext highlighter-rouge">Transfrom</code> 컴포넌트를 조작하는 것이 아닌 <code class="language-plaintext highlighter-rouge">Vector3</code> 타입의 직렬화된 필드 자체를 Scene View에서 조작하고 있다. 위와 같이 필드로 선언되어있는 Vector 구조체를 Scene View의 <strong>Move-Tool</strong> 도구를 활용해 조작하는 방법을 알아보자.</p><h3 id="releases"><span class="mr-2">Releases</span><a href="#releases" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>이 블로그는 Release 1을 기준으로 작성되었기 때문에 <strong><em>deprecated</em></strong> 된 내용이 포함되어있습니다. 업데이트된 버전을 이용하시기 바랍니다.<br /> 아래는 제가 배포하는 공식 릴리스입니다.</p><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Version<th style="text-align: center">Release Date<th style="text-align: center">Source<th style="text-align: center">C#<tbody><tr><td style="text-align: center">main(unstable)<td style="text-align: center">–<td style="text-align: center"><a href="https://github.com/kgmslem/unity-move-tool/tree/main">main</a><td style="text-align: center">7.0 or higher<tr><td style="text-align: center">Release 2<td style="text-align: center">2022-02-16<td style="text-align: center"><a href="https://github.com/kgmslem/unity-move-tool/tree/release-2">release-2</a><td style="text-align: center">7.0 or higher</table></div><h2 id="2-구현에-앞서-필요한-지식"><span class="mr-2">2. 구현에 앞서 필요한 지식</span><a href="#2-구현에-앞서-필요한-지식" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>우리가 흔히 유니티에서 인스펙터를 간편히 조작하기 위해 아래와 같이 필드에 <em>Attribute</em> 를 정의한다.</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="p">[</span><span class="n">SerializeField</span><span class="p">]</span>
<span class="k">private</span> <span class="n">Vector3</span> <span class="n">privateVector</span><span class="p">;</span>
</pre></table></code></div></div><p><br /> 위 코드에서 정의한 <em>Attribute</em> 는 유니티에서 가장 자주 쓰이는 <em>Attribute</em> 중 하나인 <code class="language-plaintext highlighter-rouge">SerializeField</code>이다. 이 <em>Attribute</em> 는 <code class="language-plaintext highlighter-rouge">private</code> 필드를 인스펙터 등에서 조작 가능하게 직렬화 시켜준다. 이처럼 Vector 구조체 필드 역시 복잡한 과정 없이, 간단히 <em>Attribute</em> 의 선언만으로 쉽게 Scene View에서 조작하고 싶다. 이를 위해 위와 같이 <em>Attribute</em> 를 만들기로 결정했다.</p><p><strong><em>Attribute(특성)</em></strong>를 어떻게 구현할까? MS 공식 문서 <a href="https://docs.microsoft.com/ko-kr/dotnet/csharp/programming-guide/concepts/attributes/"><strong>특성(C#)</strong></a>에서는 아래와 같이 기술하고 있다.</p><blockquote><p>특성은 메타데이터 또는 선언적 정보를 코드(어셈블리, 형식, 메서드, 속성 등)에 연결하는 강력한 방법을 제공합니다. 특성이 프로그램 엔터티와 연결되면 <strong><em>리플렉션</em></strong> 이라는 기법을 사용하여 런타임에 특성이 쿼리될 수 있습니다. 자세한 내용은 <a href="https://docs.microsoft.com/ko-kr/dotnet/csharp/programming-guide/concepts/reflection"><strong>리플렉션(C#)</strong></a>을 참조하세요.</p></blockquote><p>위 내용만 봐서는 프로그래밍에 깊은 지식과 이해가 있지 않은 한 이해하기 어렵다고 생각한다. 또한 <strong><em>Reflection(리플렉션)</em></strong>이라는 개념도 등장한다. 이들은 C#의 고급기술에 속한다(뇌피셜). 나도 처음에는 다소 생소하고 어려웠었다. 그러나 <strong>Move-Tool</strong> 구현을 위해 <em>Reflection</em> 에 대해 알아갈 수록, 정말 대단한 기능이라고 느껴질 정도로 강력한 기능이었다. 이에 대해 간단히 알아보자.</p><h3 id="atribute특성"><span class="mr-2">Atribute(특성)</span><a href="#atribute특성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>먼저, <em>Attribute</em>에 대해 내가 이해한 핵심적인 요약은 아래와 같다.</p><blockquote><p><strong><em>Attribute</em></strong> 는 <strong>프로그램이 이해할 수 있는 주석</strong>이다.</p></blockquote><p>우리가 주석을 작성하는 이유는 개발하는 나, 코드를 읽는 다른 개발자가 코드의 내용을 이해할 수 있게 하기 위해 작성한다. <em>Attribute</em> 역시 그러하다. 프로그램에게 이 클래스, 인터페이스, 메서드, 프로퍼티 혹은 필드가 이러한 <strong>특성</strong>을 지니고 있다라고 알려주는 역할을 한다. 예를 들면 C#에서 가장 유명한 <em>Attribute</em> 중 하나인 <code class="language-plaintext highlighter-rouge">Obsolete</code>는 프로그램 혹은 컴파일러에게 <strong>더 이상 사용되지 않는다</strong>라고 알려준다.<br /> 마찬가지로 우리가 Vector 구조체를 Scene View에서 조작할 수 있게 하기 위해 <em>Attribute</em> 를 만들려고 한 이유도 이와 같다. 즉, 이 필드는 <strong>Scene View에서 Position을 조작할 수 있는 Move-Tool 도구를 지원</strong>해야한다고 프로그램에게 알리기 위해서이다.</p><h3 id="reflection리플렉션"><span class="mr-2">Reflection(리플렉션)</span><a href="#reflection리플렉션" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>그렇다면 누가 어떤 <em>Attribute</em> 를 가지고 있는지 알 수 있을까? C#에서는 <strong><em>Reflection(리플렉션)</em></strong> 이라는 기법을 통해 가능하다. <em>Reflection</em> 은 <strong>런타임</strong>에 <strong>어떤 타입에 대한 정보를 뜯어볼 수 있도록 해준다</strong>. 이는 굉장한 기능이다. 우리가 선언한 클래스 혹은 인터페이스를 비롯해 각종 메서드, 필드에 대해 런타임에 확인하고 조작할 수 있다는 것을 의미한다. 어떤 클래스 내에 선언한 필드에 어떤 <em>Attribute</em> 가 할당되어있는지 역시 런타임에 조사가 가능하다.<br /> 이것이 가능한 이유는 바로 아래와 같다.</p><blockquote><p>C#의 모든 타입의 Base Class인 <code class="language-plaintext highlighter-rouge">Object</code> Class에 <code class="language-plaintext highlighter-rouge">Type GetType()</code> 메서드가 선언되어 있다.<br /> 즉, 모든 형식의 타입에 대해 정보를 열람할 수 있다.</p></blockquote><p>앞서 말했듯이 <em>Reflection</em> 은 <strong>어떤 타입에 대한 정보를 뜯어볼 수 있도록 해준다</strong>. 즉, 어떤 타입에 대한 정보를 담고 있는 보관함이 필요한데, 그게 바로 <code class="language-plaintext highlighter-rouge">System.Type</code> 클래스이다. <code class="language-plaintext highlighter-rouge">Type</code> 인스턴스를 통해 어떤 타입의 정보를 열람하고, 타입 멤버의 데이터를 얻거나 수정이 가능하다. 자세한 내용은 MS 공식 문서 <a href="https://docs.microsoft.com/ko-kr/dotnet/csharp/programming-guide/concepts/reflection"><strong>리플렉션(C#)</strong></a>을 참조하기 바란다.</p><h2 id="3-전체-알고리즘"><span class="mr-2">3. 전체 알고리즘</span><a href="#3-전체-알고리즘" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>위에서 구현을 위한 지식을 간단히 소개했다. 필요한 문법은 아래에서 간단히 소개할 것이나, 자세한 내용이 궁금하다면 직접 문서를 참조하길 권장한다.<br /> 아래는 소스코드가 있는 <strong>Github</strong> 링크이다. 소스코드가 상당히 길기 때문에, <strong>Github Repository</strong>에서도 제공하였다.</p><blockquote><p><a href="https://github.com/kgmslem/unity-move-tool"><strong>Code from Github</strong></a></p></blockquote><h2 id="4-movetoolattribute"><span class="mr-2">4. MoveToolAttribute</span><a href="#4-movetoolattribute" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>먼저, 필요한 <em>Attribute</em> 를 선언하자. 나는 Scene View에서 <strong>Move-Tool</strong> 도구를 지원해준다는 의미로 <code class="language-plaintext highlighter-rouge">MoveToolAttribute</code>라는 이름으로 선언했다.</p><script src="https://gist.github.com/kgmslem/16e9c6caf39e64848dcdf26517f995d6.js"></script><p><br /> C#에서 <strong><em>Attribute(특성)</em></strong> 를 생성하기 위해서는 <code class="language-plaintext highlighter-rouge">System.Attribute</code> 클래스의 상속을 받아야 한다. 위 코드에서는 <code class="language-plaintext highlighter-rouge">UnityEngine.PropertyAttribute</code>를 상속받았는데 이 클래스는 <code class="language-plaintext highlighter-rouge">Attribute</code>클래스의 파생 클래스이다. 따라서 <em>Attribute</em> 를 만들 수 있다.</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="p">[</span><span class="nf">AttributeUsage</span><span class="p">(</span><span class="n">AttributeTargets</span><span class="p">.</span><span class="n">Field</span><span class="p">,</span> <span class="n">AllowMultiple</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span> <span class="n">Inherited</span> <span class="p">=</span> <span class="k">true</span><span class="p">)]</span>
</pre></table></code></div></div><p><br /> 위 코드는 우리가 만들려는 <em>Attribute</em> 의 특성을 기술하는 <code class="language-plaintext highlighter-rouge">AttributeUsage</code> 특성이다.<br /> <code class="language-plaintext highlighter-rouge">System.AttributeTargets</code>은 C#에 정의되어 있는 <code class="language-plaintext highlighter-rouge">enum</code> 타입이다. 특성을 적용하는 데 유효한 애플리케이션 요소(클래스, 구조체, 메서드, 필드 등)를 지정할 수 있다. 참고로 <code class="language-plaintext highlighter-rouge">AttributeTargets</code>의 열거형 값은 <code class="language-plaintext highlighter-rouge">AttributeTargets.Class | AttributeTargets.Method</code>와 같이 <strong>비트 OR 연산으로 결합</strong> 하여 사용할 수 있다.<br /> 우리는 Vector 타입의 <strong>필드</strong>에만 적용할 거기 때문에 <code class="language-plaintext highlighter-rouge">AttributeUsage</code>의 생성자에 <code class="language-plaintext highlighter-rouge">AttributeTargets.Field</code> 값을 인자로 주었다. 이에 대한 자세한 내용은 MS 공식 문서 <a href="https://docs.microsoft.com/ko-kr/dotnet/api/system.attributetargets?view=net-6.0"><strong>AttributeTargets 열거형</strong></a>에서 확인하기 바란다.</p><h2 id="5-movetoolavailableattribute"><span class="mr-2">5. MoveToolAvailableAttribute</span><a href="#5-movetoolavailableattribute" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Vector 타입이 아닌 Vector 타입의 필드 및 컬렉션을 포함하는 커스텀 타입에서 <strong>Move-Tool</strong> 도구를 사용하고 싶을 때 정의해야하는 <em>Attribute</em> 이다.</p><script src="https://gist.github.com/kgmslem/bd23146b268b4708b10432367b50eeef.js"></script><p><br /> <em>Attribute</em> 적용 대상은 <code class="language-plaintext highlighter-rouge">class</code>와 <code class="language-plaintext highlighter-rouge">struct</code>이다.</p><h2 id="6-movetooleditor"><span class="mr-2">6. MoveToolEditor</span><a href="#6-movetooleditor" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-plaintext highlighter-rouge">MoveToolAttribute</code>를 정의한 필드를 위해 <strong>Move-Tool(Position Handle)</strong>을 유니티 에디터의 Scene View에 생성 및 배치하는 기능을 구현한다. 이를 위해 커스텀 에디터를 만들어야 한다.</p><h3 id="전체-알고리즘"><span class="mr-2">전체 알고리즘</span><a href="#전체-알고리즘" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>C#의 <em>Reflection</em>과 <em>Attribute</em> 기능을 최대한 활용하여 구현했다.<br /> 참고로 흔히 에디터를 작성할 때 사용하는 <code class="language-plaintext highlighter-rouge">Editor</code> 베이스 클래스의 멤버인 <code class="language-plaintext highlighter-rouge">serializedObject</code> 프로퍼티나 기타 방법을 통해 얻을 수 있는 <code class="language-plaintext highlighter-rouge">SerializedProperty</code> 타입의 직렬화된 프로퍼티들을 전혀 활용하지 않는다. 이전에 이것들을 활용해 코드를 작성했었는데 아래와 같은 치명적인 문제가 있었다.</p><p><img data-src="/assets/images/serialized-object-exception.png" alt="serialized-object-exception" data-proofer-ignore></p><p>Unity 공식 문서 <a href="https://docs.unity3d.com/ScriptReference/Editor-serializedObject.html"><strong>Editor.serializedObject</strong></a>의 설명</p><blockquote><p>Do not use the serializedObject inside OnSceneGUI or OnPreviewGUI. <strong>Use the target property directly</strong> in those callback functions instead.</p></blockquote><p>근데 이해가 안갔던 점은 <code class="language-plaintext highlighter-rouge">MoveToolEditor</code>를 다른 Editor에서 생성 후 <code class="language-plaintext highlighter-rouge">OnSceneGUI</code>를 호출할때에만 위의 Exception 발생했었다. 즉, 다른 Editor를 사용하지 않고 <code class="language-plaintext highlighter-rouge">MoveToolEditor</code>가 단독으로 사용되면 <code class="language-plaintext highlighter-rouge">serializedObject</code>를 <code class="language-plaintext highlighter-rouge">OnSceneGUI</code>에서 사용하더라도 Exception이 발생하지 않았다.<br /> 또한 Exception 메세지는 발생하지만 기능 자체는 정상적으로 동작했다. 그럼에도 계속 Exception 메세지가 콘솔창에 쌓이기 떄문에 결국 버그 수정을 위해 완전히 리뉴얼했다.</p><p>이 포스트에서 소개하는 코드는 리뉴얼된 버전으로 <code class="language-plaintext highlighter-rouge">serializedObject</code>를 사용하지 않고, C#의 순수 <em>Reflection</em> 기능만을 활용해 알고리즘을 구현하였다.<br /> 아래는 <code class="language-plaintext highlighter-rouge">MoveToolEditor</code>의 전체 알고리즘이다.</p><script src="https://gist.github.com/kgmslem/3227bf196c22d09e61f56e20dfd6f4eb.js"></script><h3 id="getserializedfields"><span class="mr-2">GetSerializedFields</span><a href="#getserializedfields" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>어떤 타입의 모든 직렬화된 필드를 열거자로 반환한다.</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1">// Return SerializedFields.</span>
<span class="k">private</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">FieldInfo</span><span class="p">&gt;</span> <span class="nf">GetSerializedFields</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">fields</span> <span class="p">=</span> <span class="n">type</span><span class="p">.</span><span class="nf">GetFields</span><span class="p">(</span><span class="n">BindingFlags</span><span class="p">.</span><span class="n">Instance</span> <span class="p">|</span> <span class="n">BindingFlags</span><span class="p">.</span><span class="n">Public</span> <span class="p">|</span> <span class="n">BindingFlags</span><span class="p">.</span><span class="n">NonPublic</span><span class="p">);</span>

    <span class="c1">// If it's the public field and doesn't have NonSerializedAttribute, then add it.</span>
    <span class="c1">// If it's the non-public field and has UnityEngine.SerializeField, then add it.</span>
    <span class="kt">var</span> <span class="n">serializedFields</span> <span class="p">=</span>
        <span class="k">from</span> <span class="n">f</span> <span class="k">in</span> <span class="n">fields</span>
        <span class="k">where</span> <span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">IsPublic</span> <span class="p">&amp;&amp;</span> <span class="n">f</span><span class="p">.</span><span class="n">GetCustomAttribute</span><span class="p">&lt;</span><span class="n">NonSerializedAttribute</span><span class="p">&gt;(</span><span class="k">false</span><span class="p">)</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="p">||</span> <span class="p">(!</span><span class="n">f</span><span class="p">.</span><span class="n">IsPublic</span> <span class="p">&amp;&amp;</span> <span class="n">f</span><span class="p">.</span><span class="n">GetCustomAttribute</span><span class="p">&lt;</span><span class="n">SerializeField</span><span class="p">&gt;(</span><span class="k">false</span><span class="p">)</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
        <span class="k">select</span> <span class="n">f</span><span class="p">;</span>

    <span class="k">return</span> <span class="n">serializedFields</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p><br /> <strong>LINQ 쿼리문</strong>을 통해 필드들을 필터링했다. <strong>public</strong> 필드는 <code class="language-plaintext highlighter-rouge">NonSerializedAttribute</code>가 존재하지 않을 때, <strong>non-public</strong> 필드는 <code class="language-plaintext highlighter-rouge">UnityEngine.SerializeField</code>가 존재할 때 직렬화가 가능하기 때문에, 이에 대해 필터링 후 열거자 형태로 반환한다.</p><h3 id="setmovetool"><span class="mr-2">SetMoveTool</span><a href="#setmovetool" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><code class="language-plaintext highlighter-rouge">SetMoveTool()</code> 메서드는 에디터의 <strong>Move-Tool</strong> 기능을 실행시켜주는 메서드이다.</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// Run MoveToolEditor. You can use position handles of fields that have MoveToolAttribute in the unity editor scene view. </span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">SetMoveTool</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">targetType</span> <span class="p">=</span> <span class="n">target</span><span class="p">.</span><span class="nf">GetType</span><span class="p">();</span>
    <span class="kt">var</span> <span class="n">fields</span> <span class="p">=</span> <span class="nf">GetSerializedFields</span><span class="p">(</span><span class="n">targetType</span><span class="p">);</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">field</span> <span class="k">in</span> <span class="n">fields</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Check if MoveToolAttribute is defined.</span>
        <span class="kt">var</span> <span class="n">attr</span> <span class="p">=</span> <span class="n">field</span><span class="p">.</span><span class="n">GetCustomAttribute</span><span class="p">&lt;</span><span class="n">MoveToolAttribute</span><span class="p">&gt;(</span><span class="k">false</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">attr</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="k">continue</span><span class="p">;</span>

        <span class="nf">SetMoveToolAvailableField</span><span class="p">((</span><span class="n">field</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">),</span> <span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">),</span> <span class="n">attr</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="n">target</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><br /> 위 코드에서 <code class="language-plaintext highlighter-rouge">target</code>은 <strong>inpected</strong>되고 있는 오브젝트로, 보통 유니티 에디터의 Hierarchy 창에서 선택한 오브젝트이다.<br /> <strong>target</strong> 오브젝트의 모든 직렬화된 필드를 <code class="language-plaintext highlighter-rouge">GetSerializedFields()</code>를 통해 가져온다. 그 중 <code class="language-plaintext highlighter-rouge">MoveToolAttribute</code>가 존재하는 필드만 <strong>Move-Tool</strong> 기능을 구현하며, 이를 위해 <code class="language-plaintext highlighter-rouge">SetMoveToolAvailableField()</code> 메서드를 호출한다.</p><p>위 메서드에서 사용한 <code class="language-plaintext highlighter-rouge">GetCustomAttribute&lt;T&gt;()</code>는 <code class="language-plaintext highlighter-rouge">System.Reflection</code>의 확장 메서드로, 어떤 멤버에 정의되어 있는 <em>Attribute</em> 를 반환한다. MS 공식 문서 <a href="https://docs.microsoft.com/ko-kr/dotnet/api/system.reflection.customattributeextensions.getcustomattribute?view=net-6.0#System_Reflection_CustomAttributeExtensions_GetCustomAttribute__1_System_Reflection_MemberInfo_System_Boolean_"><strong>GetCustomAttribute&lt;T&gt;(MemberInfo, Boolean)</strong></a></p><h3 id="hasavailableattribute"><span class="mr-2">HasAvailableAttribute</span><a href="#hasavailableattribute" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>해당 타입에 <code class="language-plaintext highlighter-rouge">MoveToolAvailableAttribute</code>와 <code class="language-plaintext highlighter-rouge">SerializableAttribute</code>가 정의되어 있는지 확인한다. 이는 커스텀 타입이 <strong>Move-Tool</strong> 기능을 사용할 수 있는지 확인하기 위한 메서드이다.</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1">// Check if both MoveToolAvailableAttribute and SerializableAttribute are defined.</span>
<span class="k">private</span> <span class="kt">bool</span> <span class="nf">HasAvailableAttribute</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">available</span> <span class="p">=</span> <span class="n">type</span><span class="p">.</span><span class="n">GetCustomAttribute</span><span class="p">&lt;</span><span class="n">MoveToolAvailableAttribute</span><span class="p">&gt;(</span><span class="k">false</span><span class="p">);</span>
    <span class="kt">var</span> <span class="n">seralizable</span> <span class="p">=</span> <span class="n">type</span><span class="p">.</span><span class="n">GetCustomAttribute</span><span class="p">&lt;</span><span class="n">SerializableAttribute</span><span class="p">&gt;(</span><span class="k">false</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">available</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">&amp;&amp;</span> <span class="n">seralizable</span> <span class="p">!=</span> <span class="k">null</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="isvector"><span class="mr-2">IsVector</span><a href="#isvector" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>해당 타입이 Vector이거나 Vector 컬렉션인지를 확인하기 위한 메서드이다.</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c1">// Check if it's vector type or vector collection type.</span>
<span class="k">private</span> <span class="kt">bool</span> <span class="nf">IsVector</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="n">type</span> <span class="p">==</span> <span class="k">typeof</span><span class="p">(</span><span class="n">Vector2</span><span class="p">)</span> <span class="p">||</span> <span class="n">type</span> <span class="p">==</span> <span class="k">typeof</span><span class="p">(</span><span class="n">Vector3</span><span class="p">)</span> <span class="p">||</span>
    <span class="k">typeof</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Vector3</span><span class="p">&gt;).</span><span class="nf">IsAssignableFrom</span><span class="p">(</span><span class="n">type</span><span class="p">)</span> <span class="p">||</span> <span class="k">typeof</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Vector2</span><span class="p">&gt;).</span><span class="nf">IsAssignableFrom</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>
</pre></table></code></div></div><h3 id="addindexlabel"><span class="mr-2">AddIndexLabel</span><a href="#addindexlabel" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>단순히 레이블에 인덱스 기호와 번호를 추가해주는 메서드이다.</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="c1">// Add index label to this label parameter.</span>
<span class="c1">// e.g. Label [index]</span>
<span class="k">private</span> <span class="kt">string</span> <span class="nf">AddIndexLabel</span><span class="p">(</span><span class="kt">string</span> <span class="n">label</span><span class="p">,</span> <span class="kt">int</span> <span class="n">index</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">isFront</span> <span class="p">=</span> <span class="k">false</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="p">&gt;=</span> <span class="m">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">isFront</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">label</span> <span class="p">=</span> <span class="s">$"[</span><span class="p">{</span><span class="n">index</span><span class="p">}</span><span class="s">] </span><span class="p">{</span><span class="n">label</span><span class="p">}</span><span class="s">"</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">label</span> <span class="p">+=</span> <span class="s">$" [</span><span class="p">{</span><span class="n">index</span><span class="p">}</span><span class="s">]"</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">label</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="setmovetoolavailablefield"><span class="mr-2">SetMoveToolAvailableField</span><a href="#setmovetoolavailablefield" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>드디어 메인 코드이다.<br /> 유니티 에디터의 Scene View에 <strong>Move-Tool</strong> 기능을 구현하기 위해 관련 요소를 파악한다. 최상위 필드에서 최하위 목록까지 내려가 최종적으로 구현 가능한지 조건을 따져 <strong>Move-Tool</strong> 기능을 구현하는 Top-down 방식의 메서드이다.<br /> 코드가 재귀호출 구조이며 상당히 복잡한 편이다. 일단은 대략적인 구조만 살펴보고 아래 설명을 본 후 다시 돌아와서 전체 구조를 살펴보는걸 권장한다.</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
</pre><td class="rouge-code"><pre><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// Set Position Handles in the unity editor scene view.</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="top"&gt;top level field declared in the MonoBehaviour component&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="current"&gt;current field checked now, current.obj is the instance where current.field is declared&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="attr"&gt;defined for the top level field&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="n"&gt;Don't set any value. It's the count of recursive calls.&lt;/param&gt;</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">SetMoveToolAvailableField</span><span class="p">((</span><span class="n">FieldInfo</span> <span class="n">field</span><span class="p">,</span> <span class="kt">int</span> <span class="n">index</span><span class="p">)</span> <span class="n">top</span><span class="p">,</span> <span class="p">(</span><span class="kt">object</span> <span class="n">obj</span><span class="p">,</span> <span class="n">FieldInfo</span> <span class="n">field</span><span class="p">,</span> <span class="kt">int</span> <span class="n">index</span><span class="p">)</span> <span class="n">current</span><span class="p">,</span> <span class="n">MoveToolAttribute</span> <span class="n">attr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span> <span class="p">=</span> <span class="m">0</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// If it's vector, call immediately SetPositionHandle() method and then terminate.</span>
    <span class="k">if</span> <span class="p">(</span><span class="nf">IsVector</span><span class="p">(</span><span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="n">FieldType</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="kt">string</span> <span class="n">label</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">attr</span><span class="p">.</span><span class="n">LabelOn</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">label</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">attr</span><span class="p">.</span><span class="n">Label</span><span class="p">)</span> <span class="p">?</span> <span class="nf">AddIndexLabel</span><span class="p">(</span><span class="n">top</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="nf">InspectorLabel</span><span class="p">(),</span> <span class="n">top</span><span class="p">.</span><span class="n">index</span><span class="p">)</span> <span class="p">:</span> <span class="nf">AddIndexLabel</span><span class="p">(</span><span class="n">attr</span><span class="p">.</span><span class="n">Label</span><span class="p">,</span> <span class="n">top</span><span class="p">.</span><span class="n">index</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">top</span><span class="p">.</span><span class="n">field</span> <span class="p">!=</span> <span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">)</span>
                <span class="n">label</span> <span class="p">+=</span> <span class="s">$" - </span><span class="p">{(</span><span class="n">n</span> <span class="p">&gt;</span> <span class="m">1</span> <span class="p">?</span> <span class="nf">AddIndexLabel</span><span class="p">(</span><span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="nf">InspectorLabel</span><span class="p">(),</span> <span class="n">current</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="p">:</span> <span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="nf">InspectorLabel</span><span class="p">())}</span><span class="s">"</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nf">SetVectorField</span><span class="p">(</span><span class="n">current</span><span class="p">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">attr</span><span class="p">.</span><span class="n">LocalMode</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">var</span> <span class="n">type</span> <span class="p">=</span> <span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="n">FieldType</span><span class="p">;</span> <span class="c1">//current field type</span>

    <span class="c1">// Array</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="p">.</span><span class="n">IsArray</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">type</span> <span class="p">=</span> <span class="n">type</span><span class="p">.</span><span class="nf">GetElementType</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(!</span><span class="nf">HasAvailableAttribute</span><span class="p">(</span><span class="n">type</span><span class="p">))</span>
            <span class="k">return</span><span class="p">;</span>

        <span class="kt">var</span> <span class="n">serializedFields</span> <span class="p">=</span> <span class="nf">GetSerializedFields</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">array</span> <span class="p">=</span> <span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">current</span><span class="p">.</span><span class="n">obj</span><span class="p">)</span> <span class="k">as</span> <span class="n">Array</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">array</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">top</span><span class="p">.</span><span class="n">field</span> <span class="p">==</span> <span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">)</span>
                <span class="n">top</span><span class="p">.</span><span class="n">index</span> <span class="p">=</span> <span class="n">i</span><span class="p">;</span>

            <span class="c1">// Recursive call for each field declared in the element type of current array</span>
            <span class="kt">object</span> <span class="n">obj</span> <span class="p">=</span> <span class="n">array</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">nextField</span> <span class="k">in</span> <span class="n">serializedFields</span><span class="p">)</span>
                <span class="nf">SetMoveToolAvailableField</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">nextField</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">attr</span><span class="p">,</span> <span class="n">n</span> <span class="p">+</span> <span class="m">1</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="p">.</span><span class="n">IsValueType</span><span class="p">)</span>
                <span class="n">array</span><span class="p">.</span><span class="nf">SetValue</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">// List</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="p">.</span><span class="n">IsGenericType</span> <span class="p">&amp;&amp;</span> <span class="k">typeof</span><span class="p">(</span><span class="n">IList</span><span class="p">).</span><span class="nf">IsAssignableFrom</span><span class="p">(</span><span class="n">type</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">type</span> <span class="p">=</span> <span class="n">type</span><span class="p">.</span><span class="nf">GetGenericArguments</span><span class="p">()[</span><span class="m">0</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(!</span><span class="nf">HasAvailableAttribute</span><span class="p">(</span><span class="n">type</span><span class="p">))</span>
            <span class="k">return</span><span class="p">;</span>

        <span class="kt">var</span> <span class="n">serializedFields</span> <span class="p">=</span> <span class="nf">GetSerializedFields</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">list</span> <span class="p">=</span> <span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">current</span><span class="p">.</span><span class="n">obj</span><span class="p">)</span> <span class="k">as</span> <span class="n">IList</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">list</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">top</span><span class="p">.</span><span class="n">field</span> <span class="p">==</span> <span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">)</span>
                <span class="n">top</span><span class="p">.</span><span class="n">index</span> <span class="p">=</span> <span class="n">i</span><span class="p">;</span>

            <span class="c1">// Recursive call for each field declared in the element type of current list</span>
            <span class="kt">object</span> <span class="n">obj</span> <span class="p">=</span> <span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">nextField</span> <span class="k">in</span> <span class="n">serializedFields</span><span class="p">)</span>
                <span class="nf">SetMoveToolAvailableField</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">nextField</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">attr</span><span class="p">,</span> <span class="n">n</span> <span class="p">+</span> <span class="m">1</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="p">.</span><span class="n">IsValueType</span><span class="p">)</span>
                <span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="n">obj</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">// Just single field</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(!</span><span class="nf">HasAvailableAttribute</span><span class="p">(</span><span class="n">type</span><span class="p">))</span>
            <span class="k">return</span><span class="p">;</span>       

        <span class="kt">var</span> <span class="n">serializedFields</span> <span class="p">=</span> <span class="nf">GetSerializedFields</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>

        <span class="c1">// Recursive call for each field declared in the current field type</span>
        <span class="kt">object</span> <span class="n">obj</span> <span class="p">=</span> <span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">current</span><span class="p">.</span><span class="n">obj</span><span class="p">);</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">nextField</span> <span class="k">in</span> <span class="n">serializedFields</span><span class="p">)</span>
            <span class="nf">SetMoveToolAvailableField</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">nextField</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">),</span> <span class="n">attr</span><span class="p">,</span> <span class="n">n</span> <span class="p">+</span> <span class="m">1</span><span class="p">);</span>

        <span class="c1">// If current field is a value type, you must copy boxed obj to this field. It's because obj isn't the field instance itself, but new boxed instance.</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="p">.</span><span class="n">IsValueType</span><span class="p">)</span>
            <span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="nf">SetValue</span><span class="p">(</span><span class="n">current</span><span class="p">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">obj</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h4 id="현재-필드가-vector일-경우"><span class="mr-2">현재 필드가 Vector일 경우</span><a href="#현재-필드가-vector일-경우" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>현재 필드가 Vector일 경우 <strong>Move-Tool</strong> 기능을 위한 <strong>Position Handle</strong>을 유니티 Scene View에 생성 및 배치하는 <code class="language-plaintext highlighter-rouge">SetPositionHandle()</code> 메서드를 호출하고 재귀호출을 종료한다. <code class="language-plaintext highlighter-rouge">SetPositionHandle()</code> 메서드는 뒤에서 자세히 설명할 예정이다.</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1">// If it's vector, call immediately SetPositionHandle() method and then terminate.</span>
<span class="k">if</span> <span class="p">(</span><span class="nf">IsVector</span><span class="p">(</span><span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="n">FieldType</span><span class="p">))</span>
<span class="p">{</span>
    <span class="kt">string</span> <span class="n">label</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">attr</span><span class="p">.</span><span class="n">LabelOn</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">label</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">attr</span><span class="p">.</span><span class="n">Label</span><span class="p">)</span> <span class="p">?</span> <span class="nf">AddIndexLabel</span><span class="p">(</span><span class="n">top</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="nf">InspectorLabel</span><span class="p">(),</span> <span class="n">top</span><span class="p">.</span><span class="n">index</span><span class="p">)</span> <span class="p">:</span> <span class="nf">AddIndexLabel</span><span class="p">(</span><span class="n">attr</span><span class="p">.</span><span class="n">Label</span><span class="p">,</span> <span class="n">top</span><span class="p">.</span><span class="n">index</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">top</span><span class="p">.</span><span class="n">field</span> <span class="p">!=</span> <span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">)</span>
            <span class="n">label</span> <span class="p">+=</span> <span class="s">$" - </span><span class="p">{(</span><span class="n">n</span> <span class="p">&gt;</span> <span class="m">1</span> <span class="p">?</span> <span class="nf">AddIndexLabel</span><span class="p">(</span><span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="nf">InspectorLabel</span><span class="p">(),</span> <span class="n">current</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="p">:</span> <span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="nf">InspectorLabel</span><span class="p">())}</span><span class="s">"</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nf">SetVectorField</span><span class="p">(</span><span class="n">current</span><span class="p">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">attr</span><span class="p">.</span><span class="n">LocalMode</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><h4 id="vector가-아닌-단일-필드일-경우"><span class="mr-2">Vector가 아닌 단일 필드일 경우</span><a href="#vector가-아닌-단일-필드일-경우" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>먼저 위 <code class="language-plaintext highlighter-rouge">SetMoveToolAvailableField()</code> 메서드의 조건문 분기 중 <code class="language-plaintext highlighter-rouge">else</code>문 부터 보자.<br /> Vector 타입이 아닌 커스텀 타입의 컬렉션이 아닌 단일 필드일 경우의 처리이다.</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c1">// Just single field</span>
<span class="k">else</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(!</span><span class="nf">HasAvailableAttribute</span><span class="p">(</span><span class="n">type</span><span class="p">))</span>
        <span class="k">return</span><span class="p">;</span>       

    <span class="kt">var</span> <span class="n">serializedFields</span> <span class="p">=</span> <span class="nf">GetSerializedFields</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>

    <span class="c1">// Recursive call for each field declared in the current field type</span>
    <span class="kt">object</span> <span class="n">obj</span> <span class="p">=</span> <span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">current</span><span class="p">.</span><span class="n">obj</span><span class="p">);</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">nextField</span> <span class="k">in</span> <span class="n">serializedFields</span><span class="p">)</span>
        <span class="nf">SetMoveToolAvailableField</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">nextField</span><span class="p">,</span> <span class="p">-</span><span class="m">1</span><span class="p">),</span> <span class="n">attr</span><span class="p">,</span> <span class="n">n</span> <span class="p">+</span> <span class="m">1</span><span class="p">);</span>

    <span class="c1">// If current field is a value type, you must copy boxed obj to this field. It's because obj isn't the field instance itself, but new boxed instance.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="p">.</span><span class="n">IsValueType</span><span class="p">)</span>
        <span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="nf">SetValue</span><span class="p">(</span><span class="n">current</span><span class="p">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">obj</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p><br /> 현재 필드의 타입이 <strong>Move-Tool</strong> 기능을 이용 가능한지 확인하기 위해 앞서 정의했던 <code class="language-plaintext highlighter-rouge">HasAvailableAttribute()</code> 메서드를 호출한다.<br /> 이용 가능하다면, 현재 타입에 선언되어 있는 모든 직렬화된 필드를 <code class="language-plaintext highlighter-rouge">GetSerializedFields()</code> 메서드를 통해 가져온다.<br /> 현재 필드 인스턴스를 <code class="language-plaintext highlighter-rouge">FieldInfo.GetValue()</code> 메서드를 통해 얻은 후 <code class="language-plaintext highlighter-rouge">object obj</code> 지역변수에 할당한다.<br /> 현재 필드 타입에 정의된 각각의 직렬화된 필드에 대해 <code class="language-plaintext highlighter-rouge">SetMoveToolAvailableField()</code> 메서드를 재귀 호출한다.<br /> 이때, <code class="language-plaintext highlighter-rouge">current</code> 튜플 매개변수의 <code class="language-plaintext highlighter-rouge">obj</code>에 직전에 얻은 지역변수 <code class="language-plaintext highlighter-rouge">obj</code>, <code class="language-plaintext highlighter-rouge">field</code>에 현재 필드 타입에 정의된 각각의 직렬화된 필드, <code class="language-plaintext highlighter-rouge">index</code>에 인덱스를 인자로 넘겨준다. 현재 필드는 배열이 아닌 단일 필드이기 때문에 인덱스는 -1의 값을 준다.</p><h5 id="fieldinfogetvalue"><span class="mr-2">FieldInfo.GetValue()</span><a href="#fieldinfogetvalue" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p><code class="language-plaintext highlighter-rouge">FieldInfo.GetValue()</code> 메서드는 리플렉션의 핵심 기능 중 하나이다. 우리가 어떤 인스턴스와 그 인스턴스에 선언된 필드 정보를 알고 있다면, 그 인스턴스의 필드가 보유하고 있는 실제 값을 알아낼 수 있다. 반대로 <code class="language-plaintext highlighter-rouge">FieldInfo.SetValue()</code> 메서드도 존재한다.<br /> 이것은 정말 강력한 기능이다. 그 이유는 아래와 같다.</p><blockquote><p>어떤 클래스 혹은 구조체 필드가 <code class="language-plaintext highlighter-rouge">private</code>이나 <code class="language-plaintext highlighter-rouge">protected</code> 등의 키워드를 통해 외부로부터 보호되고 있는 필드일 지라도, <strong>그 필드에 대한 정보만 안다면, 외부에서 그 필드가 보유하고 있는 값을 알아내고 수정</strong>할 수 있다.</p></blockquote><p>자세한 내용은 MS 공식 문서 <a href="https://docs.microsoft.com/ko-kr/dotnet/api/system.reflection.fieldinfo.getvalue?view=net-6.0"><strong>FieldInfo.GetValue(Object) 메서드</strong></a>를 참조하기 바란다.</p><h5 id="구조체에-대한-리플렉션"><span class="mr-2">구조체에 대한 리플렉션</span><a href="#구조체에-대한-리플렉션" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>현재 필드 타입에 정의된 각각의 직렬화된 필드에 대한 재귀호출이 모두 끝났다면, 지역변수 <code class="language-plaintext highlighter-rouge">obj</code> 인스턴스에 대한 각각의 직렬화된 필드들은 모두 값이 변경되었다. 이때, 현재 필드가 구조체인 <em>value type</em> 이라면 문제가 발생한다.<br /> 현재 필드가 클래스라면 <code class="language-plaintext highlighter-rouge">obj</code> 지역변수는 곧 <code class="language-plaintext highlighter-rouge">current.obj</code>를 통해 얻은 실제 인스턴스 그 자체이다. 몰론 엄밀하게는 인스턴스에 대한 참조이다.<br /> 그러나 구조체라면 <code class="language-plaintext highlighter-rouge">current.obj</code>를 통해 얻은 인스턴스 참조가 아닌, 값만 동일한 박싱되어 새롭게 생성된 인스턴스이다. 이는 <em>value type</em> 의 박싱 언박싱 과정때문이다. 따라서 지역변수 <code class="language-plaintext highlighter-rouge">obj</code>를 변경하더라도 새롭게 생성된 인스턴스를 변경한 것이기 때문에 기존에 <code class="language-plaintext highlighter-rouge">current.obj</code>가 보관하고 있는 현재 필드는 변경되지 않는다. 따라서 변경된 <code class="language-plaintext highlighter-rouge">obj</code> 지역변수를 현재 필드에 복사해줘야한다.<br /> 위 이유로 구조체를 고려하지 않았을 때는 구조체에 대해서는 <strong>Position Handle</strong> 자체는 표시했지만 핸들을 움직이려고 시도해도 고정된채로 남아있었다.</p><h4 id="vector가-아닌-배열-혹은-컬렉션-필드일-경우"><span class="mr-2">Vector가 아닌 배열 혹은 컬렉션 필드일 경우</span><a href="#vector가-아닌-배열-혹은-컬렉션-필드일-경우" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Vector가 아닌 배열 혹은 컬렉션 필드는 위 <a href="#vector가-아닌-단일-필드일-경우"><strong>Vector가 아닌 단일 필드일 경우</strong></a>에서 소개한 내용의 연장선일 뿐이다. 단지, 현재 단일 필드에 대해서가 아닌, 배열 혹은 컬렉션의 각각의 원소에 대해서 재귀호출을 실행한다는 차이가 있다. 배열과 컬렉션은 원리가 완전히 동일하므로 여기서는 배열에 대해서만 코드를 제시한다.<br /> 참고로 이 코드에서의 <code class="language-plaintext highlighter-rouge">GetValue()</code>, <code class="language-plaintext highlighter-rouge">SetValue()</code>는 <code class="language-plaintext highlighter-rouge">FieldInfo.GetValue()</code>, <code class="language-plaintext highlighter-rouge">FieldInfo.SetValue()</code>가 아닌 <code class="language-plaintext highlighter-rouge">Array.GetValue()</code>, <code class="language-plaintext highlighter-rouge">Array.SetValue()</code>이다.</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="c1">// Array</span>
<span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="p">.</span><span class="n">IsArray</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">type</span> <span class="p">=</span> <span class="n">type</span><span class="p">.</span><span class="nf">GetElementType</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(!</span><span class="nf">HasAvailableAttribute</span><span class="p">(</span><span class="n">type</span><span class="p">))</span>
        <span class="k">return</span><span class="p">;</span>

    <span class="kt">var</span> <span class="n">serializedFields</span> <span class="p">=</span> <span class="nf">GetSerializedFields</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>
    <span class="kt">var</span> <span class="n">array</span> <span class="p">=</span> <span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">current</span><span class="p">.</span><span class="n">obj</span><span class="p">)</span> <span class="k">as</span> <span class="n">Array</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">array</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">top</span><span class="p">.</span><span class="n">field</span> <span class="p">==</span> <span class="n">current</span><span class="p">.</span><span class="n">field</span><span class="p">)</span>
            <span class="n">top</span><span class="p">.</span><span class="n">index</span> <span class="p">=</span> <span class="n">i</span><span class="p">;</span>

        <span class="c1">// Recursive call for each field declared in the element type of current array</span>
        <span class="kt">object</span> <span class="n">obj</span> <span class="p">=</span> <span class="n">array</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">nextField</span> <span class="k">in</span> <span class="n">serializedFields</span><span class="p">)</span>
            <span class="nf">SetMoveToolAvailableField</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">nextField</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">attr</span><span class="p">,</span> <span class="n">n</span> <span class="p">+</span> <span class="m">1</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">type</span><span class="p">.</span><span class="n">IsValueType</span><span class="p">)</span>
            <span class="n">array</span><span class="p">.</span><span class="nf">SetValue</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="setpositionhandle"><span class="mr-2">SetPositionHandle</span><a href="#setpositionhandle" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>벡터 타입의 필드나 컬렉션에 대해 <strong>Move-Tool</strong> 기능을 위한 <strong>Position Handle</strong>을 유니티 에디터 Scene View에 실제로 생성 및 배치하는 메서드이다.</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
</pre><td class="rouge-code"><pre><span class="c1">// Add position handles of this field to unity editor scene view. This field is okay whether vector field or vector collection field.</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">SetVectorField</span><span class="p">(</span><span class="kt">object</span> <span class="n">obj</span><span class="p">,</span> <span class="n">FieldInfo</span> <span class="n">field</span><span class="p">,</span> <span class="kt">string</span> <span class="n">label</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">localMode</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// If it's local mode, then origin point is set to target(MonoBehaviour) position.</span>
    <span class="n">Vector3</span> <span class="n">origin</span> <span class="p">=</span> <span class="n">localMode</span> <span class="p">?</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">target</span> <span class="k">as</span> <span class="n">MonoBehaviour</span><span class="p">).</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">:</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">zero</span><span class="p">;</span>

    <span class="kt">var</span> <span class="n">fieldType</span> <span class="p">=</span> <span class="n">field</span><span class="p">.</span><span class="n">FieldType</span><span class="p">;</span>

    <span class="c1">// Field</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">fieldType</span> <span class="p">==</span> <span class="k">typeof</span><span class="p">(</span><span class="n">Vector3</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">Vector3</span> <span class="n">oldValue</span> <span class="p">=</span> <span class="p">(</span><span class="n">Vector3</span><span class="p">)</span><span class="n">field</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>      
        <span class="nf">SetHandleVector3</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">oldValue</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">v</span> <span class="p">=&gt;</span> <span class="n">field</span><span class="p">.</span><span class="nf">SetValue</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">v</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">fieldType</span> <span class="p">==</span> <span class="k">typeof</span><span class="p">(</span><span class="n">Vector2</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">Vector2</span> <span class="n">oldValue</span> <span class="p">=</span> <span class="p">(</span><span class="n">Vector2</span><span class="p">)</span><span class="n">field</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>
        <span class="nf">SetHandleVector2</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">oldValue</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">v</span> <span class="p">=&gt;</span> <span class="n">field</span><span class="p">.</span><span class="nf">SetValue</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">v</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="c1">// Array</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">fieldType</span><span class="p">.</span><span class="nf">GetElementType</span><span class="p">()</span> <span class="p">==</span> <span class="k">typeof</span><span class="p">(</span><span class="n">Vector3</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">array</span> <span class="p">=</span> <span class="n">field</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="k">as</span> <span class="n">Array</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">array</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">temp</span> <span class="p">=</span> <span class="n">label</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(!</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
                <span class="n">temp</span> <span class="p">+=</span> <span class="s">$" [</span><span class="p">{</span><span class="n">i</span><span class="p">}</span><span class="s">]"</span><span class="p">;</span>

            <span class="n">Vector3</span> <span class="n">oldValue</span> <span class="p">=</span> <span class="p">(</span><span class="n">Vector3</span><span class="p">)</span><span class="n">array</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="nf">SetHandleVector3</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">oldValue</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">v</span> <span class="p">=&gt;</span> <span class="n">array</span><span class="p">.</span><span class="nf">SetValue</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">i</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">fieldType</span><span class="p">.</span><span class="nf">GetElementType</span><span class="p">()</span> <span class="p">==</span> <span class="k">typeof</span><span class="p">(</span><span class="n">Vector2</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">array</span> <span class="p">=</span> <span class="n">field</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="k">as</span> <span class="n">Array</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">array</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">temp</span> <span class="p">=</span> <span class="n">label</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(!</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
                <span class="n">temp</span> <span class="p">+=</span> <span class="s">$" [</span><span class="p">{</span><span class="n">i</span><span class="p">}</span><span class="s">]"</span><span class="p">;</span>

            <span class="n">Vector2</span> <span class="n">oldValue</span> <span class="p">=</span> <span class="p">(</span><span class="n">Vector2</span><span class="p">)</span><span class="n">array</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="nf">SetHandleVector2</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">oldValue</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">v</span> <span class="p">=&gt;</span> <span class="n">array</span><span class="p">.</span><span class="nf">SetValue</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">i</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">// List</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">fieldType</span> <span class="p">==</span> <span class="k">typeof</span><span class="p">(</span><span class="n">List</span><span class="p">&lt;</span><span class="n">Vector3</span><span class="p">&gt;))</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">list</span> <span class="p">=</span> <span class="n">field</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="k">as</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Vector3</span><span class="p">&gt;;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">list</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">temp</span> <span class="p">=</span> <span class="n">label</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(!</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
                <span class="n">temp</span> <span class="p">+=</span> <span class="s">$" [</span><span class="p">{</span><span class="n">i</span><span class="p">}</span><span class="s">]"</span><span class="p">;</span>

            <span class="n">Vector3</span> <span class="n">oldValue</span> <span class="p">=</span> <span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="nf">SetHandleVector3</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">oldValue</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">v</span> <span class="p">=&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="n">v</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">fieldType</span> <span class="p">==</span> <span class="k">typeof</span><span class="p">(</span><span class="n">List</span><span class="p">&lt;</span><span class="n">Vector2</span><span class="p">&gt;))</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">list</span> <span class="p">=</span> <span class="n">field</span><span class="p">.</span><span class="nf">GetValue</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="k">as</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Vector2</span><span class="p">&gt;;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">list</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">temp</span> <span class="p">=</span> <span class="n">label</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(!</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
                <span class="n">temp</span> <span class="p">+=</span> <span class="s">$" [</span><span class="p">{</span><span class="n">i</span><span class="p">}</span><span class="s">]"</span><span class="p">;</span>

            <span class="n">Vector2</span> <span class="n">oldValue</span> <span class="p">=</span> <span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="nf">SetHandleVector2</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">oldValue</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">v</span> <span class="p">=&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="n">v</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">// If you want to use position handles of other serializable collection, then add here or modify list part.</span>
<span class="p">}</span>
</pre></table></code></div></div><p><br /> 위 메서드에서 중요한 포인트는 <strong>Position Handle</strong>을 배치하고 필드의 값을 변경하기 위해 <code class="language-plaintext highlighter-rouge">FieldInfo.GetValue()</code>와 <code class="language-plaintext highlighter-rouge">FieldInfo.SetValue()</code> 메서드를 활용하고 있다는 점이다. 필드에 대한 정보만 알고 있다면 그 필드의 값을 얻거나 수정하는게 가능하다.</p><h3 id="sethandlevector3--sethandlevector2"><span class="mr-2">SetHandleVector3 &amp; SetHandleVector2</span><a href="#sethandlevector3--sethandlevector2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>이 메서드들은 각각 <code class="language-plaintext highlighter-rouge">Vector3</code>와 <code class="language-plaintext highlighter-rouge">Vector2</code> 타입의 값에 대해 실제로 Position Handle을 배치하고 값을 변경하는 메서드이다. 리플렉션을 통해 값을 수정하고 있기 때문에 <code class="language-plaintext highlighter-rouge">Undo.RecordObject()</code>와 <code class="language-plaintext highlighter-rouge">PrefabUtility.RecordPrefabInstancePropertyModifications()</code>를 호출해줘야 한다. 그런데 <code class="language-plaintext highlighter-rouge">PrefabUtility.RecordPrefabInstancePropertyModifications()</code>의 경우 유니티 공식문서에서는 호출하라고 적혀있지만 사용하지 않아도 기존 기능과 차이가 없다. 이유를 모르겠다.</p><blockquote><p><a href="https://docs.unity3d.com/ScriptReference/Undo.RecordObject.html"><strong>Undo.RecordObject - Scripting API - Unity</strong></a></p></blockquote><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre><span class="c1">// Create Position Handle for Vector3. If it's changed, set and record new value.</span>
<span class="c1">// You need to implement a mechanism to set the new Vector3 value in setValue delegate.</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">SetHandleVector3</span><span class="p">(</span><span class="kt">string</span> <span class="n">label</span><span class="p">,</span> <span class="n">Vector3</span> <span class="n">origin</span><span class="p">,</span> <span class="n">Vector3</span> <span class="n">oldValue</span><span class="p">,</span> <span class="kt">object</span> <span class="n">obj</span><span class="p">,</span> <span class="n">FieldInfo</span> <span class="n">field</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">Vector3</span><span class="p">&gt;</span> <span class="n">setValue</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Handles</span><span class="p">.</span><span class="nf">Label</span><span class="p">(</span><span class="n">origin</span> <span class="p">+</span> <span class="n">oldValue</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">style</span><span class="p">);</span>
    <span class="n">EditorGUI</span><span class="p">.</span><span class="nf">BeginChangeCheck</span><span class="p">();</span>
    <span class="n">Vector3</span> <span class="n">newValue</span> <span class="p">=</span> <span class="n">Handles</span><span class="p">.</span><span class="nf">PositionHandle</span><span class="p">(</span><span class="n">origin</span> <span class="p">+</span> <span class="n">oldValue</span><span class="p">,</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">identity</span><span class="p">)</span> <span class="p">-</span> <span class="n">origin</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">EditorGUI</span><span class="p">.</span><span class="nf">EndChangeCheck</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="c1">// enable ctrl + z &amp; set dirty</span>
        <span class="n">Undo</span><span class="p">.</span><span class="nf">RecordObject</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s">$"</span><span class="p">{</span><span class="n">target</span><span class="p">.</span><span class="n">name</span><span class="p">}</span><span class="s">_</span><span class="p">{</span><span class="n">target</span><span class="p">.</span><span class="nf">GetInstanceID</span><span class="p">()}</span><span class="s">_</span><span class="p">{</span><span class="n">obj</span><span class="p">.</span><span class="nf">GetHashCode</span><span class="p">()}</span><span class="s">_</span><span class="p">{</span><span class="n">field</span><span class="p">.</span><span class="n">Name</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>

        <span class="nf">setValue</span><span class="p">(</span><span class="n">newValue</span><span class="p">);</span>

        <span class="c1">// In the unity document, if the object may be part of a Prefab instance, we have to call this method.</span>
        <span class="c1">// But, even if i don't call this method, it works well. I don't know the reason.</span>
        <span class="n">PrefabUtility</span><span class="p">.</span><span class="nf">RecordPrefabInstancePropertyModifications</span><span class="p">(</span><span class="n">target</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Create Position Handle for Vector2. If it's changed, set and record new value.</span>
<span class="c1">// You need to implement a mechanism to set the new Vector2 value in setValue delegate.</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">SetHandleVector2</span><span class="p">(</span><span class="kt">string</span> <span class="n">label</span><span class="p">,</span> <span class="n">Vector2</span> <span class="n">origin</span><span class="p">,</span> <span class="n">Vector2</span> <span class="n">oldValue</span><span class="p">,</span> <span class="kt">object</span> <span class="n">obj</span><span class="p">,</span> <span class="n">FieldInfo</span> <span class="n">field</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">Vector2</span><span class="p">&gt;</span> <span class="n">setValue</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Handles</span><span class="p">.</span><span class="nf">Label</span><span class="p">(</span><span class="n">origin</span> <span class="p">+</span> <span class="n">oldValue</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">style</span><span class="p">);</span>
    <span class="n">EditorGUI</span><span class="p">.</span><span class="nf">BeginChangeCheck</span><span class="p">();</span>
    <span class="n">Vector2</span> <span class="n">newValue</span> <span class="p">=</span> <span class="p">(</span><span class="n">Vector2</span><span class="p">)</span><span class="n">Handles</span><span class="p">.</span><span class="nf">PositionHandle</span><span class="p">(</span><span class="n">origin</span> <span class="p">+</span> <span class="n">oldValue</span><span class="p">,</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">identity</span><span class="p">)</span> <span class="p">-</span> <span class="n">origin</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">EditorGUI</span><span class="p">.</span><span class="nf">EndChangeCheck</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="c1">// enable ctrl + z &amp; set dirty</span>
        <span class="n">Undo</span><span class="p">.</span><span class="nf">RecordObject</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s">$"</span><span class="p">{</span><span class="n">target</span><span class="p">.</span><span class="n">name</span><span class="p">}</span><span class="s">_</span><span class="p">{</span><span class="n">target</span><span class="p">.</span><span class="nf">GetInstanceID</span><span class="p">()}</span><span class="s">_</span><span class="p">{</span><span class="n">obj</span><span class="p">.</span><span class="nf">GetHashCode</span><span class="p">()}</span><span class="s">_</span><span class="p">{</span><span class="n">field</span><span class="p">.</span><span class="n">Name</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>

        <span class="nf">setValue</span><span class="p">(</span><span class="n">newValue</span><span class="p">);</span>

        <span class="c1">// In the unity document, if the object may be part of a Prefab instance, we have to call this method.</span>
        <span class="c1">// But, even if i don't call this method, it works well. I don't know the reason.</span>
        <span class="n">PrefabUtility</span><span class="p">.</span><span class="nf">RecordPrefabInstancePropertyModifications</span><span class="p">(</span><span class="n">target</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="7-정리"><span class="mr-2">7. 정리</span><a href="#7-정리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>우리는 <code class="language-plaintext highlighter-rouge">MonoBehaviour</code>에 대한 단 하나의 에디터만을 작성했으며 이를 모든 <code class="language-plaintext highlighter-rouge">MonoBehaviour</code> 컴포넌트 객체에 적용할 수 있다. 만약, 리플렉션을 활용하지 않으면 어떤 컴포넌트의 필드에 <strong>Move-Tool</strong> 기능을 구현하고 싶을 때마다 그 컴포넌트에 대한 에디터를 새롭게 작성하고, 그 필드에 값을 넣는 코드를 매번 작성해야 한다. 이는 굉장히 비효율적이다.<br /> 그러나 <em>Reflection</em> 을 활용하면 위와 같이 동적으로 제어할 수 있다. 개발자가 만든 어떤 타입의 어떤 필드에 <strong>Move-Tool</strong> 기능을 구현할 지는 모르겠지만, 개발자가 <strong>Move-Tool</strong> 기능을 구현해달라고 <code class="language-plaintext highlighter-rouge">MoveToolAttribute</code>를 선언만 하면, 자동으로 에디터는 이 <em>Attribute</em>를 인식해 관련된 필드 정보를 가져와 <strong>Move-Tool</strong> 기능을 구현하여, 값을 변경시켜준다.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/unity/'>Unity</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/unity/" class="post-tag no-text-decoration" >Unity</a> <a href="/tags/unity-editor/" class="post-tag no-text-decoration" >Unity Editor</a> <a href="/tags/attribute/" class="post-tag no-text-decoration" >Attribute</a> <a href="/tags/reflection/" class="post-tag no-text-decoration" >Reflection</a> <a href="/tags/vector/" class="post-tag no-text-decoration" >Vector</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%5BUnity%5D+Scene+View%EC%97%90%EC%84%9C+Vector%EC%9D%98+Position+Handle+%EC%A1%B0%EC%9E%91%ED%95%98%EA%B8%B0+-+DevSlem+Blog&url=https%3A%2F%2Fdevslem.github.io%2Funity%2Funity-movetool-release1%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%5BUnity%5D+Scene+View%EC%97%90%EC%84%9C+Vector%EC%9D%98+Position+Handle+%EC%A1%B0%EC%9E%91%ED%95%98%EA%B8%B0+-+DevSlem+Blog&u=https%3A%2F%2Fdevslem.github.io%2Funity%2Funity-movetool-release1%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fdevslem.github.io%2Funity%2Funity-movetool-release1%2F&text=%5BUnity%5D+Scene+View%EC%97%90%EC%84%9C+Vector%EC%9D%98+Position+Handle+%EC%A1%B0%EC%9E%91%ED%95%98%EA%B8%B0+-+DevSlem+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div><script src="https://utteranc.es/client.js" repo="DevSlem/DevSlem.github.io" issue-term="pathname" label="comment" theme="github-dark" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/reinforcement-learning/drl-methods/dqn/">DQN: Deep Q-Networks</a><li><a href="/reinforcement-learning/drl-methods/dtqn/">DTQN: Deep Transformer Q-Networks for Partially Observable Reinforcement Learning</a><li><a href="/wsl-setup/">Windows Subsystem for Linux (WSL) Setup for Reinforcement Learning</a><li><a href="/algorithm/sorting/merge-sort/">[알고리즘] 합병 정렬</a><li><a href="/algorithm/sorting/shell-sort/">[알고리즘] 쉘 정렬</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ai/">AI</a> <a class="post-tag" href="/tags/rl/">RL</a> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/unity/">Unity</a> <a class="post-tag" href="/tags/function-approximation-rl/">Function Approximation RL</a> <a class="post-tag" href="/tags/sorting/">Sorting</a> <a class="post-tag" href="/tags/enemy/">Enemy</a> <a class="post-tag" href="/tags/game-development/">Game Development</a> <a class="post-tag" href="/tags/project/">Project</a> <a class="post-tag" href="/tags/attribute/">Attribute</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/numerical-analysis/newton-polynomial/"><div class="card-body"> <em class="small" data-ts="1639148400" data-df="ll" > Dec 11, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[수치해석] 뉴턴 다항식 보간법</h3><div class="text-muted small"><p> Introduction 당연하지만 프로그래밍에서 보간법(Interpolation)은 굉장히 중요한 영역이다. 주어진 데이터는 한정적이지만 우리가 예측해야하는 범위는 너무 넓다. 그래서 필요한 것이 보간법 (Interpolation)이다. 예를 들면 다음과 같은 점의 위치를 우리가 이미 알고 있거나 주어졌다고 하자. [(-1, 0), (0, 0), ...</p></div></div></a></div><div class="card"> <a href="/unity/unity-first-game-mini-boss/"><div class="card-body"> <em class="small" data-ts="1639494000" data-df="ll" > Dec 15, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Unity] 유니티 첫 게임 - 미니 보스</h3><div class="text-muted small"><p> 1. 개요 Unity로 개발한 첫 게임에서 구현한 미니보스를 소개한다. 사용한 에셋은 Bringer Of Death이다. 유니티 에셋스토어에서 무료로 구할 수 있다. 참고로 스킬, 이동, 체력 관리는 모두 직접 코딩해야 한다. 에셋에는 스프라이트 관련 파일만 존재한다. 2. 스킬 스킬 구성은 크게 3개로 나눴다. 더 구현하고 싶은 욕심이 있지만...</p></div></div></a></div><div class="card"> <a href="/unity/unity-first-game-ninja/"><div class="card-body"> <em class="small" data-ts="1639580400" data-df="ll" > Dec 16, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Unity] 유니티 첫 게임 - 닌자</h3><div class="text-muted small"><p> 1. 개요 Unity로 개발한 첫 게임에서 구현한 닌자 몬스터를 소개한다. 사용한 에셋은 Ninja Sprite Sheet이며 유니티 에셋 스토어에서 무료로 구할 수 있다. 참고로 스킬, 이동, 체력 관리는 모두 직접 코딩해야 한다. 에셋에는 스프라이트 관련 파일만 존재한다. 구현된 닌자 몬스터의 특징은 다음과 같다. 플레이어가 도망칠 수...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/unity/unity-first-game-boss/" class="btn btn-outline-primary" prompt="Older"><p>[Unity] 유니티 첫 게임 - 첫번째 보스 리퍼</p></a> <a href="/deep-learning/deep-learning-basic/" class="btn btn-outline-primary" prompt="Newer"><p>Deep Learning Basics (딥러닝 기초)</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/username">DevSlem</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ai/">AI</a> <a class="post-tag" href="/tags/rl/">RL</a> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/unity/">Unity</a> <a class="post-tag" href="/tags/function-approximation-rl/">Function Approximation RL</a> <a class="post-tag" href="/tags/sorting/">Sorting</a> <a class="post-tag" href="/tags/enemy/">Enemy</a> <a class="post-tag" href="/tags/game-development/">Game Development</a> <a class="post-tag" href="/tags/project/">Project</a> <a class="post-tag" href="/tags/attribute/">Attribute</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
